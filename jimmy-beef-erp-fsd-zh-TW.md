# **功能規格文件 (FSD)**

## **Jimmy Beef ERP 系統**

**版本：** 1.0
**日期：** 2025年11月24日
**文件類型：** 業務功能規格
**目標讀者：** 業務利益關係人、營運經理、終端使用者

---

## **目錄**

1. [介紹](#1-介紹)
2. [系統概述](#2-系統概述)
3. [使用者角色與存取權限](#3-使用者角色與存取權限)
4. [客戶入口網站功能](#4-客戶入口網站功能)
5. [管理入口網站功能](#5-管理入口網站功能)
6. [訂單生命週期與業務規則](#6-訂單生命週期與業務規則)
7. [包裝與配送流程](#7-包裝與配送流程)
8. [定價與客戶管理](#8-定價與客戶管理)
9. [庫存管理](#9-庫存管理)
10. [會計整合](#10-會計整合)
11. [通知與通訊](#11-通知與通訊)
12. [業務規則摘要](#12-業務規則摘要)

---

## **1. 介紹**

### **1.1 目的**

本文件從業務角度描述 Jimmy Beef ERP 系統的運作方式。說明使用者可以執行的操作、流程如何進行，以及管理系統行為的規則。本文件不涵蓋技術實作細節。

### **1.2 範圍**

系統由兩個網路入口網站組成：
- **客戶入口網站** - 供企業客戶瀏覽產品和下訂單
- **管理入口網站** - 供 Jimmy Beef 員工管理營運

### **1.3 業務目標**

- 讓客戶能夠全天候 24/7 線上下訂單
- 簡化訂單處理並減少人工作業
- 優化配送路線以提高效率
- 維護準確的庫存水準
- 與 Xero (會計軟體) 系統整合
- 為客戶和員工提供訂單狀態的可見度

---

## **2. 系統概述**

### **2.1 系統功能**

Jimmy Beef ERP 系統管理澳洲 B2B 肉品配銷業務的整個訂單到配送工作流程：

1. **客戶** 線上註冊、申請信用額度、以其議定價格瀏覽產品並下訂單
2. **銷售/管理員工** 核准信用申請、管理客戶帳戶並確認訂單
3. **倉庫包裝人員** 收到彙整的包裝清單，依最佳順序包裝訂單以便裝車，並標記訂單已備妥配送
4. **司機** 收到配送排程與優化路線，配送訂單並取得配送證明
5. **系統** 自動管理庫存、建立會計發票、發送電子郵件通知並優化配送路線

### **2.2 主要業務流程**

| 流程 | 說明 |
|---------|-------------|
| **客戶入駐** | 新企業客戶註冊、提供企業資訊並申請信用額度 |
| **信用核准** | 管理員審核信用申請並設定信用額度和付款條件 |
| **下訂單** | 客戶選擇產品並下訂單（受截止時間和信用額度限制） |
| **訂單處理** | 管理員確認訂單、庫存被保留、訂單排入包裝佇列 |
| **包裝** | 倉庫員工依最佳順序包裝訂單（後進先出裝車原則） |
| **配送** | 司機依優化路線配送訂單並取得配送證明 |
| **開立發票** | 訂單配送完成時，系統自動在 Xero 中建立發票 |
| **庫存管理** | 系統追蹤庫存水準、發出低庫存警示並維護交易記錄 |

---

## **3. 使用者角色與存取權限**

### **3.1 客戶（外部使用者）**

**身分：** 向 Jimmy Beef 購買肉品的企業買家

**可執行的操作：**
- 註冊新帳戶並申請信用額度
- 以專屬價格瀏覽產品目錄
- 線上下訂單（信用已核准時）
- 查看訂單記錄和追蹤配送狀態
- 更新聯絡資訊和配送地址
- 取消待處理的訂單（在管理員確認之前）

**無法執行的操作：**
- 查看其他客戶的資訊或訂單
- 存取管理功能或內部營運
- 若信用申請待審核或被拒絕則無法下訂單
- 管理員確認訂單後無法取消

### **3.2 管理員（內部使用者）**

**身分：** 擁有完整系統存取權限的高階管理層

**可執行的操作：**
- 系統中的所有操作
- 核准或拒絕信用申請
- 管理所有客戶、產品和訂單
- 設定系統參數（截止時間、配送區域、稅率）
- 連接 Xero 會計系統
- 查看所有報表和分析
- 取消任何階段的訂單（後期取消需經理核准）

**無法執行的操作：**
- （無限制 - 完整存取權限）

### **3.3 銷售（內部使用者）**

**身分：** 管理客戶關係的銷售代表

**可執行的操作：**
- 查看和更新客戶資訊
- 設定客戶專屬產品定價
- 代客戶下訂單
- 查看所有訂單
- 確認待處理的訂單

**無法執行的操作：**
- 核准信用申請（僅限管理員）
- 存取庫存管理
- 變更公司設定
- 存取包裝或配送介面

### **3.4 包裝人員（內部使用者）**

**身分：** 負責包裝訂單的倉庫員工

**可執行的操作：**
- 查看所選配送日期的包裝介面
- 查看彙整的產品清單（所需總數量）
- 以最佳包裝順序查看個別訂單
- 標記項目為已包裝
- 標記訂單為「已備妥配送」
- 新增包裝備註

**無法執行的操作：**
- 存取客戶管理
- 查看定價資訊
- 取消或修改訂單
- 存取其他模組

### **3.5 司機（內部使用者）**

**身分：** 配送訂單給客戶的配送司機

**可執行的操作：**
- 查看當天的指派配送
- 查看配送地址和路線順序
- 標記訂單為「配送中」
- 上傳配送證明（照片或簽名）
- 標記訂單為「已配送」
- 附註原因退回未配送的訂單

**無法執行的操作：**
- 存取其他客戶的訂單（僅限指派的配送）
- 修改訂單詳情
- 存取管理功能

### **3.6 經理（內部使用者）**

**身分：** 監督業務績效的營運經理

**可執行的操作：**
- 查看系統中的所有資料（僅限閱讀）
- 存取報表和分析
- 匯出資料進行分析

**無法執行的操作：**
- 修改任何資料
- 核准信用申請
- 處理訂單

---

## **4. 客戶入口網站功能**

### **4.1 客戶註冊**

**流程：**

1. 客戶造訪客戶入口網站
2. 點擊「註冊」並以電子郵件和密碼建立帳戶
3. 填寫企業資料表單：
   - 企業名稱和 ABN（澳洲商業號碼）
   - 聯絡人詳情（姓名、電話、電子郵件）
   - 配送地址（街道、區域、州、郵遞區號）
   - 帳單地址（若與配送地址不同）
   - 選填：申請的信用額度和付款條件偏好
   - 同意條款和條件
4. 系統驗證：
   - ABN 格式（11 位數字）
   - 區域在服務配送範圍內
   - 電子郵件為唯一
5. 系統建立客戶帳戶，狀態為「待核准」
6. 客戶收到確認電子郵件
7. 管理員收到審核信用申請的通知

**業務規則：**
- 新客戶在信用核准前無法下訂單
- 配送地址必須在服務區域內（北區、東區、南區或西區）
- 若區域不在系統中，客戶仍可註冊但需管理員核准
- 系統根據區域自動指派配送區域

### **4.2 產品瀏覽**

**客戶看到的內容：**

- **產品目錄** 顯示所有可用產品
- **產品詳情** 每個項目包含：
  - 產品名稱和說明
  - SKU（產品代碼）
  - 單位類型（公斤、件、箱、紙箱）
  - 包裝規格（例如「5公斤箱」）
  - **專屬價格**（若已議定）或基本價格
  - 庫存狀態指示：
    - 🟢「有庫存」- 充足
    - 🟡「低庫存」- 即將售罄
    - 🔴「缺貨」- 無法訂購

**功能：**
- 依產品名稱或 SKU 搜尋
- 依類別篩選（牛肉、羊肉、豬肉、家禽）
- 依名稱、價格或類別排序
- 查看產品說明和規格

**業務規則：**
- 若銷售團隊已設定客製價格，客戶會看到議定價格
- 若無客製價格，則顯示標準基本價格
- 已停售產品不向客戶顯示
- 缺貨產品可見但無法加入購物車

### **4.3 下訂單**

**流程：**

1. 客戶瀏覽產品並將項目加入購物車
2. 客戶指定每項產品的數量
3. 客戶進入結帳
4. 系統顯示訂單截止警示：
   - **下午 2:00 前**（可設定）：「下午 2:00 前下單可隔日配送」
   - **下午 2:00 後**：「訂單截止時間已過。您的訂單將排定於 [日期]。如需緊急配送請聯繫我們。」
5. 客戶確認：
   - 訂單項目和數量
   - 價格（已套用客戶專屬價格）
   - 小計
   - GST（10% 澳洲稅）
   - 總金額
   - 配送地址
   - 要求的配送日期
6. 客戶提交訂單
7. 系統驗證：
   - 客戶已有核准的信用額度
   - 訂單總額未超過信用額度
   - 配送日期有效
8. 系統檢查庫存狀態：
   - **若所有項目都有庫存**：正常建立訂單，庫存被保留
   - **若任何項目超過庫存**：訂單成為**缺貨訂單**需要管理員核准（見 4.5 缺貨訂單流程）
9. 系統建立訂單並發送確認電子郵件
10. 管理員/銷售團隊收到通知

**業務規則：**
- **訂單截止時間**：截止時間前下的訂單（例如下午 2:00）排定為隔日配送
- **截止後**：截止後下的訂單需管理員審核配送日期
- **信用額度**：系統檢查目前未結餘額 + 新訂單 ≤ 信用額度
- **庫存保留**：一般訂單，下單時立即扣減庫存以防止超賣
- **缺貨訂單**：超過庫存的訂單提交給管理員核准而非直接拒絕
- **最低訂購量**：無最低訂購數量（如需可設定）

### **4.4 訂單追蹤**

**客戶可見的內容：**

| 訂單狀態 | 客戶看到的顯示 | 代表的意義 |
|--------------|---------------|-----------------|
| **Pending（待處理）** | 「您的訂單正在處理中」 | 訂單已提交，等待管理員確認 |
| **Confirmed（已確認）** | 「訂單已確認，正在準備包裝」 | 管理員已核准，準備進入倉庫作業 |
| **Packing（包裝中）** | 「您的訂單正在包裝中」 | 倉庫正在包裝訂單 |
| **Ready for Delivery（已備妥配送）** | 「訂單已包裝完成，等待發貨」 | 已包裝，等待指派司機 |
| **Out for Delivery（配送中）** | 「您的訂單正在配送途中」+ 司機姓名 | 司機正在前往配送 |
| **Delivered（已配送）** | 「訂單已於 [日期] 配送」+ 配送證明 | 成功配送 |
| **Cancelled（已取消）** | 「訂單已取消」+ 原因 | 訂單已被取消 |

**缺貨訂單狀態（適用時與訂單狀態一同顯示）：**

| 缺貨訂單狀態 | 客戶看到的顯示 | 代表的意義 |
|------------------|---------------|-----------------|
| **Awaiting Approval（待核准）** | 「訂單因庫存問題待核准中」 | 部分項目超過目前庫存，管理員正在審核 |
| **Approved Backorder（缺貨訂單已核准）** | 「缺貨訂單已核准」 | 管理員已核准訂單，儘管庫存不足 |
| **Partially Approved（部分核准）** | 「部分核准 - 請查看詳情」 | 部分數量已被管理員調整 |
| **Backorder Rejected（缺貨訂單已拒絕）** | 「缺貨訂單已拒絕」 | 管理員無法核准訂單 |

**功能：**
- 查看所有過去訂單的日期、總額和狀態
- 依狀態或日期範圍篩選訂單
- 點擊訂單查看完整詳情
- 查看庫存不足訂單的缺貨訂單狀態和詳情
- 下載訂單確認 PDF（未來功能）
- 配送完成時查看配送證明照片/簽名

**業務規則：**
- 客戶只能查看自己的訂單
- 客戶只能取消「Pending（待處理）」狀態的訂單
- 訂單一旦為「Confirmed（已確認）」或之後的狀態，取消需聯繫管理員
- 待核准的缺貨訂單可由客戶取消

### **4.5 缺貨訂單流程（客戶體驗）**

**庫存不足時會發生什麼：**

1. 客戶正常完成結帳
2. 提交時，系統偵測到一或多個項目超過可用庫存
3. 客戶看到通知：「您訂單中的部分項目超過目前庫存。您的訂單已提交待核准。」
4. 訂單出現在「我的訂單」中，狀態徽章顯示「Awaiting Approval（待核准）」
5. 客戶收到說明缺貨訂單流程和預計時程的電子郵件

**等待期間：**

- 客戶可查看訂單詳情以了解哪些項目庫存不足
- 客戶可取消訂單如果不想繼續等待
- 客戶可下其他訂單（待處理的缺貨訂單不會佔用信用額度）
- 一般審核時間：1-2 個工作日

**管理員決定後：**

| 決定 | 客戶看到的內容 | 電子郵件通知 |
|----------|-------------------|-------------------|
| **完全核准** | 訂單移至「Confirmed（已確認）」並顯示「Approved Backorder（缺貨訂單已核准）」徽章 | 「好消息！您的缺貨訂單已核准，將會為您出貨。」 |
| **部分核准** | 訂單更新為新數量和總額 | 「您的訂單已部分核准。部分數量已調整。」 |
| **拒絕** | 訂單移至「Cancelled（已取消）」並顯示「Backorder Rejected（缺貨訂單已拒絕）」徽章 | 「很抱歉，我們無法完成您的訂單。請聯繫我們討論其他方案。」 |

**客戶無法執行的操作：**

- 無法在待核准期間修改缺貨訂單
- 無法繞過庫存檢查強制下訂單
- 無法看到關於決定的內部管理員備註

---

## **5. 管理入口網站功能**

### **5.1 儀表板**

**管理員登入時看到的內容：**

**關鍵指標（一目了然）：**
- 待審核的信用申請數量
- **待核准的缺貨訂單數量**
- 今日訂單：數量和總金額
- 今日待包裝訂單：數量
- 配送中訂單：數量
- 低庫存警示：低於門檻的產品數量
- 上次 Xero 同步狀態和時間戳記

**快速操作：**
- 「審核待處理的信用申請」按鈕
- **「審核待處理的缺貨訂單」按鈕**
- 「查看今日包裝清單」按鈕
- 「查看今日配送」按鈕
- 「檢查低庫存」按鈕
- 「與 Xero 同步」按鈕

### **5.2 公司設定**

**管理員可設定的項目：**

**企業資訊：**
- 公司名稱、ABN、電子郵件、電話
- 實體地址

**訂單設定：**
- **訂單截止時間**（例如「14:00」代表下午 2:00）
- 時區（Australia/Sydney）

**財務設定：**
- 幣別（AUD）
- GST 稅率（10%）

**庫存設定：**
- 低庫存門檻（預設警示水準）
- 低庫存警示的收件電子郵件

**配送區域：**
- 定義地理配送區域：北區、東區、南區、西區
- 指派區域到各配送區域
- 新增區域到服務範圍

**Xero 整合：**
- 連接 Xero 會計系統（OAuth 設定）
- 中斷 Xero 連接
- 查看同步狀態和錯誤

**業務規則：**
- 只有管理員角色可以修改公司設定
- 變更截止時間會影響變更後下的訂單（不溯及既往）
- 區域指派決定配送路線優化

### **5.3 客戶管理**

**客戶清單檢視：**

管理員可查看所有客戶，欄位包含：
- 企業名稱
- 聯絡人和電子郵件
- 信用狀態（Pending（待審核）、Approved（已核准）、Rejected（已拒絕））
- 信用額度
- 配送區域
- 帳戶狀態（Active（啟用）、Suspended（停用）、Closed（關閉））
- 註冊日期

**篩選：**
- 信用狀態：Pending（待審核）、Approved（已核准）、Rejected（已拒絕）
- 配送區域：北區、東區、南區、西區
- 帳戶狀態：Active（啟用）、Suspended（停用）、Closed（關閉）
- 搜尋依據：企業名稱、電子郵件、ABN

**信用核准工作流程：**

1. 管理員點擊「待審核申請」查看新客戶
2. 管理員審核客戶詳情：
   - 企業資訊
   - 申請的信用額度
   - 配送地址
3. 管理員設定：
   - **核准的信用額度**（金額）
   - **付款條件**（例如「Net 30」、「COD（貨到付款）」）
   - **內部備註**（額度原因、風險評估）
4. 管理員點擊「核准」或「拒絕」
5. 系統發送電子郵件給客戶：
   - **若核准**：「恭喜！您的信用申請已核准。您現在可以下訂單，額度上限為 $[金額]。」
   - **若拒絕**：「很抱歉，我們目前無法核准信用額度。請聯繫我們討論其他方案。」
6. 若核准，系統在 Xero 會計系統中建立客戶記錄

**客戶帳戶管理：**

管理員可以：
- **更新客戶資訊**（地址、聯絡詳情）
- **變更信用額度**（增加或減少）
- **停用帳戶**（阻止下訂單，附帶原因）
- **重新啟用已停用的帳戶**
- **關閉帳戶**（永久停用）

**活動摘要：**

針對每位客戶，管理員可查看：
- 總訂單數
- 總消費金額（終身價值）
- 平均訂單金額
- 最後訂單日期
- 未結餘額
- 信用額度使用率

**業務規則：**
- 客戶必須為「Approved（已核准）」才能下訂單
- 已停用的客戶無法登入或下訂單
- 已關閉的帳戶無法重新開啟（必須建立新帳戶）
- 變更信用額度不影響現有的待處理訂單
- 管理員在停用或關閉帳戶時必須提供原因

### **5.4 產品管理**

**產品清單檢視：**

顯示所有產品，包含：
- SKU（產品代碼）
- 產品名稱
- 類別（牛肉、羊肉、豬肉、家禽）
- 每單位基本價格
- 目前庫存水準
- 庫存狀態（OK（正常）、Low（低）、Out（缺貨））
- 產品狀態（Active（啟用）、Discontinued（已停售））

**新增/編輯產品：**

管理員可建立或修改產品：
- **SKU**：唯一產品代碼（必填）
- **名稱**：產品名稱（必填）
- **說明**：產品相關詳情
- **類別**：用於篩選的產品類別
- **單位**：公斤、件、箱或紙箱
- **包裝規格**：例如 5 代表「5公斤箱」
- **基本價格**：預設價格（澳幣）（必填）
- **目前庫存**：庫存數量
- **低庫存門檻**：低於此水準時發出警示
- **狀態**：Active（啟用）（客戶可訂購）或 Discontinued（已停售）（不向客戶顯示）

**庫存管理：**

管理員可以：
- **查看目前庫存水準**（每項產品）
- **收貨入庫**（供應商送貨時增加庫存）
  - 輸入收到的數量
  - 新增備註（例如「供應商 X 的發票 #123」）
- **調整庫存**（手動修正）
  - 輸入正數（增加庫存）
  - 輸入負數（減少庫存）
  - 選擇原因：庫存盤點修正、損壞品、過期庫存
  - 新增說明調整的備註
- **查看庫存交易記錄**（所有增減記錄，包含日期、操作人員和原因）

**低庫存警示：**

- 當產品庫存低於門檻時，系統自動發送電子郵件警示
- 警示包含：產品名稱、目前庫存、建議補貨數量
- 警示發送給倉庫經理和管理員電子郵件
- 每小時批次發送以避免過多訊息

**業務規則：**
- SKU 必須在所有產品中唯一
- 基本價格必須大於零
- 庫存不能低於零（庫存不足時系統阻止訂單）
- 已停售產品不在客戶入口網站顯示但保留在系統中
- 庫存記錄為永久性，無法刪除（稽核軌跡）

### **5.5 客戶專屬定價**

**目的：** 允許銷售團隊為個別客戶提供議定價格

**運作方式：**

**選項 1：依客戶設定定價**
1. 管理員選擇一位客戶
2. 查看所有產品清單，包含兩個價格欄位：
   - 基本價格（所有客戶的預設價格）
   - 客戶專屬價格（若已設定）
3. 管理員可以：
   - 為產品新增客製價格
   - 編輯現有的客製價格
   - 移除客製價格（客戶恢復為基本價格）
   - 設定有效日期範圍（選填）：「此價格有效期間從 [日期] 到 [日期]」
   - 新增備註（例如「合約定價至 2025 年 12 月」）

**選項 2：依產品設定定價**
1. 管理員選擇一項產品
2. 查看擁有此產品客製定價的客戶清單
3. 管理員可新增擁有特殊定價的新客戶

**客戶看到的內容：**
- 若客戶有客製定價：看到議定價格
- 若無客製定價：看到基本價格
- 客戶永遠看不到其他客戶的定價

**稽核軌跡：**
- 系統記錄每次定價變更
- 顯示：誰變更的、何時、舊價格、新價格、原因

**業務規則：**
- 客製定價覆蓋基本定價
- 只有管理員和銷售角色可以設定客製定價
- 有效日期範圍為選填（若空白，價格永久有效）
- 過期的客製定價自動恢復為基本價格
- 定價變更不影響現有訂單（訂單在下單時鎖定價格）

### **5.6 訂單管理**

**訂單清單檢視：**

**所有訂單檢視：**
- 顯示系統中的每筆訂單
- 欄位：訂單編號、客戶、日期、狀態、總額、配送日期、區域
- 篩選：狀態、日期範圍、客戶、配送區域
- 排序依據：日期、狀態、總金額
- 批次操作：匯出至 Excel/CSV

**今日訂單檢視：**
- 僅顯示今日配送的訂單
- 依狀態分組：
  - Pending（待處理）（需確認）
  - Confirmed（已確認）（準備包裝）
  - Packing（包裝中）（正在包裝）
  - Ready for delivery（已備妥配送）（已包裝，等待司機）
  - Out for delivery（配送中）（司機配送中）
  - Delivered（已配送）（今日已完成）
- 狀態更新的快速操作按鈕

**訂單詳情頁面：**

顯示完整訂單資訊：
- **客戶詳情**：名稱、聯絡人、配送地址
- **訂單項目**：產品、數量、單價、小計
- **價格明細**：小計、GST（10%）、總額
- **配送資訊**：要求日期、區域、配送說明
- **狀態記錄**：時間軸顯示每次狀態變更的時間戳記和操作人員
- **內部備註**：管理員可新增僅員工可見的備註
- **Xero 同步狀態**：若已建立則顯示發票編號，若失敗則顯示錯誤訊息

**管理員可執行的操作：**

1. **確認訂單**（Pending → Confirmed）
   - 驗證庫存仍然充足
   - 驗證客戶信用額度
   - 將訂單加入包裝佇列
   - 發送確認電子郵件給客戶

2. **取消訂單**（任何狀態 → Cancelled）
   - 輸入取消原因
   - 系統立即恢復庫存
   - 若 Xero 發票已存在，系統建立折讓單
   - 發送取消電子郵件給客戶
   - 若訂單為「Out for Delivery（配送中）」，發送緊急警示給司機要求退回訂單

3. **修改配送地址**（包裝前）
   - 針對特殊要求更新配送地址
   - 系統重新驗證區域

4. **新增內部備註**
   - 僅員工可見的私人備註
   - 例如：「客戶來電 - 需要上午 10 點前配送」

5. **重新發送確認電子郵件**
   - 若客戶未收到原始電子郵件

6. **手動 Xero 同步**
   - 若自動同步失敗，管理員可重試

**代客戶下訂單：**

銷售/管理員可為電話來電的客戶建立訂單：
1. 從下拉選單選擇客戶
2. 新增產品和數量
3. 確認定價（自動套用客戶專屬定價）
4. 設定配送日期
5. 如需要新增內部備註
6. 管理員可繞過截止時間（特殊權限）
7. 管理員可繞過信用額度（附帶說明備註）
8. 系統發送訂單確認給客戶

**業務規則：**
- 只有管理員和銷售可以確認、取消或修改訂單
- 客戶只能取消自己 Pending（待處理）狀態的訂單
- 訂單一旦為「Confirmed（已確認）」或之後的狀態，只有管理員可以取消（需經理核准）
- 取消訂單立即恢復庫存
- 訂單編號唯一且連續（ORD-2025-001234）

### **5.7 缺貨訂單管理**

**管理員看到的內容：**

當有缺貨訂單時，管理員在儀表板看到顯示待處理缺貨訂單數量的通知。點擊「審核待處理的缺貨訂單」開啟缺貨訂單佇列。

**缺貨訂單佇列檢視：**

專用清單檢視，顯示所有缺貨訂單狀態為「Pending Approval（待核准）」的訂單：
- 訂單編號和客戶名稱
- 訂單總金額
- 要求的配送日期
- 提交日期
- 庫存短缺摘要（例如「2 項低於庫存」）

**審核缺貨訂單：**

當管理員點擊缺貨訂單時，會看到：

1. **訂單詳情卡片：**
   - 訂單編號、客戶名稱、要求的配送日期
   - 訂單總金額
   - 訂單下單日期

2. **庫存狀態面板：**
   - 針對每個庫存不足的項目：
     - 產品名稱和 SKU
     - 客戶要求的數量
     - 目前可用數量
     - 短缺數量（差多少單位）
     - 顯示可用百分比的視覺化長條圖（顏色標示）

3. **核准決定區塊：**
   三個互斥選項：

   | 選項 | 說明 | 必填輸入 |
   |--------|-------------|----------------|
   | **核准完整訂單** | 承諾在庫存到貨時完成整筆訂單 | 選填：預計出貨日期、管理員備註 |
   | **部分核准** | 僅核准可用數量 | 每項產品的數量欄位、選填備註 |
   | **拒絕訂單** | 無法完成訂單 | 必填：拒絕原因（至少 10 個字元） |

**部分核准流程：**

當管理員選擇部分核准時：
1. 針對每項短缺的產品，管理員輸入核准數量
2. 系統驗證：數量必須為正數且不超過要求數量
3. 系統根據核准數量重新計算訂單總額
4. 通知客戶變更內容
5. 訂單以調整後的數量進行

**決定後的處理：**

| 決定 | 訂單狀態 | 缺貨訂單狀態 | 庫存 | 客戶通知 |
|----------|-------------|------------------|-----------|----------------------|
| **完全核准** | Confirmed（已確認） | Approved（已核准） | 庫存已保留 | 核准電子郵件附出貨日期 |
| **部分核准** | Confirmed（已確認） | Partially Approved（部分核准） | 核准數量已保留 | 電子郵件顯示原始與核准數量 |
| **拒絕** | Cancelled（已取消） | Rejected（已拒絕） | 無變更 | 拒絕電子郵件附原因 |

**管理員業務規則：**

- 只有管理員和銷售角色可以核准/拒絕缺貨訂單
- 拒絕需要說明（至少 10 個字元）
- 已核准的缺貨訂單直接移至「Confirmed（已確認）」狀態（跳過手動確認）
- 庫存僅在缺貨訂單核准時才保留（不是在提交時）
- 部分核准自動重新計算 GST 和總額
- 記錄核准/拒絕的管理員以供稽核

**訂單清單中的缺貨訂單篩選：**

主要訂單清單現包含「缺貨訂單狀態」篩選，選項如下：
- 所有缺貨訂單狀態
- 一般訂單（無缺貨訂單）
- Pending Approval（待核准）
- Approved（已核准）
- Partially Approved（部分核准）
- Rejected（已拒絕）

---

## **6. 訂單生命週期與業務規則**

### **6.1 訂單狀態流程**

**完整訂單流程：**

```
訂單建立（客戶或管理員下訂單）
    ↓
[Pending（待處理）] - 訂單等待管理員確認
    ↓ （管理員確認）
[Confirmed（已確認）] - 訂單已核准，準備包裝
    ↓ （包裝人員存取訂單 - 自動）
[Packing（包裝中）] - 倉庫正在包裝訂單
    ↓ （包裝人員標記所有項目已包裝）
[Ready for Delivery（已備妥配送）] - 已包裝，等待司機
    ↓ （司機標記配送中）
[Out for Delivery（配送中）] - 司機正在配送
    ↓ （司機上傳配送證明）
[Delivered（已配送）] - 訂單完成 ✓
```

**替代路徑：**
- 任何狀態 → **Cancelled（已取消）**（有限制 - 見下方）
- Packing（包裝中） → Confirmed（已確認）（若包裝人員閒置超過 30 分鐘 - 自動逾時）
- Out for Delivery（配送中） → Ready for Delivery（已備妥配送）（若司機無法配送並退回訂單）

### **6.2 訂單狀態規則**

#### **Pending（待處理）狀態**

**代表的意義：** 訂單已提交，等待管理員審核

**自動發生的事項：**
- 立即扣減庫存（庫存已保留）
- 檢查信用額度
- 客戶收到訂單確認電子郵件
- 管理員收到新訂單通知

**可採取操作的人員：**
- 管理員/銷售：確認訂單 → 移至 Confirmed（已確認）
- 管理員/銷售/客戶：取消訂單 → 移至 Cancelled（已取消）

**業務驗證：**
- 客戶必須有已核准的信用額度
- 訂單總額不能超過可用信用額度
- 所有項目必須有庫存
- 配送日期必須有效

#### **Confirmed（已確認）狀態**

**代表的意義：** 管理員已核准，準備進入倉庫包裝

**自動發生的事項：**
- 訂單出現在倉庫員工的包裝介面
- 客戶收到「訂單已確認」電子郵件
- 倉庫收到通知

**可採取操作的人員：**
- 包裝人員：開啟訂單 → 自動移至 Packing（包裝中）
- 管理員/銷售：取消訂單 → 移至 Cancelled（已取消）

#### **Packing（包裝中）狀態**

**代表的意義：** 倉庫員工正在積極包裝

**自動發生的事項：**
- 包裝人員在其包裝介面看到訂單
- 30 分鐘逾時開始（若閒置，恢復為 Confirmed（已確認））

**可採取操作的人員：**
- 包裝人員：標記所有項目已包裝 → 移至 Ready for Delivery（已備妥配送）
- 包裝人員：放棄作業 → 30 分鐘後自動恢復為 Confirmed（已確認）
- 管理員：取消訂單（需經理核准） → 移至 Cancelled（已取消）

**業務規則：**
- 同一時間只有一位包裝人員可以處理訂單
- 包裝人員必須標記所有項目為已包裝才能完成
- 若作業逾時，訂單再次可供任何包裝人員處理

#### **Ready for Delivery（已備妥配送）狀態**

**代表的意義：** 訂單已包裝完成，等待司機取貨

**自動發生的事項：**
- 訂單出現在司機的配送介面
- 配送團隊收到通知
- 若當日所有訂單都已備妥，可能觸發路線優化

**可採取操作的人員：**
- 司機：標記配送中 → 移至 Out for Delivery（配送中）
- 包裝人員：重新開啟以重新包裝 → 移回 Packing（包裝中）
- 管理員：取消訂單（需經理核准） → 移至 Cancelled（已取消）

#### **Out for Delivery（配送中）狀態**

**代表的意義：** 司機已取貨並正在前往客戶處

**自動發生的事項：**
- 客戶收到「訂單正在配送途中」電子郵件，附司機姓名
- 司機在其配送清單中看到訂單及路線順序

**可採取操作的人員：**
- 司機：標記已配送（附證明） → 移至 Delivered（已配送）
- 司機：退回訂單（客戶不在） → 移回 Ready for Delivery（已備妥配送）
- 管理員：緊急取消（需經理核准，立即通知司機） → 移至 Cancelled（已取消）

**業務規則：**
- 司機必須上傳配送證明（照片或簽名）才能完成
- 只有被指派的司機可以更新此訂單
- 若司機退回訂單，必須提供原因

#### **Delivered（已配送）狀態（最終）**

**代表的意義：** 訂單已成功配送給客戶

**自動發生的事項：**
- 客戶收到「訂單已配送」電子郵件，附配送證明
- 系統自動建立 Xero 發票（非同步）
- 司機的配送次數更新
- 訂單完成並鎖定（不可再變更）

**可採取操作的人員：**
- 無人可以變更狀態（最終狀態）
- 管理員可以查看配送詳情和配送證明
- 若客戶有問題，使用另外的退貨/退款流程

**業務規則：**
- 無法撤銷已配送狀態
- 配送證明永久儲存
- Xero 發票在背景建立（若失敗，通知管理員重試）

#### **Cancelled（已取消）狀態（最終）**

**代表的意義：** 訂單已取消，不會履行

**自動發生的事項：**
- 立即恢復庫存（庫存已退回）
- 客戶收到取消電子郵件，附原因
- 若 Xero 發票存在，系統建立折讓單
- 若訂單為配送中，司機收到緊急警示要求退回

**可採取操作的人員：**
- 無人可以變更狀態（最終狀態）
- 無法取消已取消的狀態（必須建立新訂單）

**業務規則：**
- 必須提供取消原因
- 已配送的訂單無法取消（改用退貨流程）

### **6.2.1 缺貨訂單工作流程**

**什麼是缺貨訂單？**

缺貨訂單發生在客戶下訂單的數量超過目前庫存時。系統不會直接拒絕訂單，而是允許提交訂單給管理員核准。

**何時建立缺貨訂單：**

當客戶提交訂單且一或多個項目超過可用庫存時，系統：
1. 以狀態「Pending（待處理）」建立訂單
2. 將訂單標記為缺貨訂單狀態「Pending Approval（待核准）」
3. 記錄哪些產品庫存不足及差額
4. 不扣減庫存（與一般訂單不同）
5. 發送通知給客戶說明情況
6. 發送通知給管理員團隊要求審核

**範例情境：**
```
客戶訂購：
  - 牛臀肉 5kg：100 單位（庫存僅 60）
  - 豬里肌 3kg：50 單位（庫存 80 - 充足）

結果：
  - 訂單建立，缺貨訂單狀態「Pending Approval（待核准）」
  - 記錄庫存短缺：牛臀肉需要再 40 單位
  - 通知客戶：「您的訂單因庫存狀況待核准中」
  - 通知管理員：「新的缺貨訂單需要您的審核」
```

**缺貨訂單狀態流程：**

```
訂單建立（偵測到庫存短缺）
    ↓
[Pending Approval（待核准）] - 等待管理員決定
    ↓
管理員審核並選擇三個選項之一：
    ├── 核准完整訂單 → [Approved（已核准）] → 訂單移至 Confirmed（已確認）
    ├── 核准部分數量 → [Partially Approved（部分核准）] → 訂單移至 Confirmed（已確認）（數量已調整）
    └── 拒絕訂單 → [Rejected（已拒絕）] → 訂單已 Cancelled（取消）
```

**管理員核准選項：**

| 選項 | 代表的意義 | 發生的事項 |
|--------|--------------|--------------|
| **核准完整訂單** | 管理員承諾在庫存到貨時完成整筆訂單 | 訂單進行，庫存保留，通知客戶預計出貨日期 |
| **核准部分數量** | 管理員僅核准可用數量 | 訂單以調整後的數量更新，重新計算總額，通知客戶變更 |
| **拒絕訂單** | 管理員無法完成訂單 | 訂單取消，通知客戶原因，庫存無變更 |

**客戶看到的內容：**

| 缺貨訂單狀態 | 客戶入口網站顯示 |
|------------------|------------------------|
| Pending Approval（待核准） | 「待核准中」- 您的訂單因庫存狀況正在審核中 |
| Approved（已核准） | 「缺貨訂單已核准」- 您的缺貨訂單已核准，將會為您出貨 |
| Partially Approved（部分核准） | 「部分核准」- 部分項目已調整。請查看下方詳情 |
| Rejected（已拒絕） | 「缺貨訂單已拒絕」- 很抱歉，我們無法完成此訂單。請聯繫我們 |

**缺貨訂單業務規則：**

1. **建立缺貨訂單時不扣減庫存** - 僅在核准時扣減
2. **待處理的缺貨訂單不計入信用額度** - 客戶可在等待期間下其他訂單
3. **管理員拒絕時必須提供備註** - 至少 10 個字元說明原因
4. **預計出貨日期為選填** - 管理員可設定預期庫存到貨時間
5. **部分核准重新計算總額** - 訂單金額調整以符合核准數量
6. **已拒絕的缺貨訂單變為已取消** - 訂單狀態自動變更為 Cancelled（已取消）

**客戶電子郵件通知：**

| 事件 | 電子郵件內容 |
|-------|--------------|
| 缺貨訂單已提交 | 「您的訂單已提交審核。部分項目超過目前庫存水準。我們將在 1-2 個工作日內通知您。」 |
| 缺貨訂單已核准 | 「好消息！您的缺貨訂單已核准。預計出貨：[日期如有提供]」 |
| 缺貨訂單部分核准 | 「您的訂單已部分核准。原始要求：[X 單位]，核准：[Y 單位]。訂單總額已調整。」 |
| 缺貨訂單已拒絕 | 「很抱歉，我們目前無法完成您的訂單。原因：[管理員原因]。請聯繫我們討論其他方案。」 |

---

### **6.3 信用額度執行**

**信用額度運作方式：**

1. **設定信用額度：** 管理員在信用核准時設定金額（例如 $10,000）

2. **計算可用信用額度：**
   ```
   可用信用額度 = 信用額度 - 未結餘額
   ```

3. **未結餘額包含：**
   - 所有狀態為以下的訂單：Pending（待處理）、Confirmed（已確認）、Packing（包裝中）、Ready for Delivery（已備妥配送）、Out for Delivery（配送中）
   - 不包含：Delivered（已配送）（已開發票）、Cancelled（已取消）（已恢復）
   - **不包含：待處理的缺貨訂單**（缺貨訂單狀態 = 「Pending Approval（待核准）」）- 這些在核准前不計入信用額度

4. **訂單驗證：**
   - 當客戶下訂單時，系統檢查：`新訂單總額 ≤ 可用信用額度`
   - 若超過，訂單被拒絕並顯示訊息：「此訂單將超過您的信用額度。請聯繫銷售人員。」

**管理員覆寫：**
- 管理員/銷售代客戶下訂單時可繞過信用額度
- 必須提供說明備註（例如「經理核准 - 長期客戶」）

**範例情境：**
- 信用額度：$10,000
- 目前未結訂單：$7,500
- 可用信用額度：$2,500
- 新訂單：$3,000
- 結果：❌ 拒絕 - 超過可用信用額度 $500

### **6.4 訂單截止時間**

**目的：** 確保訂單及時處理以便隔日配送

**運作方式：**

1. **截止時間設定：** 管理員在公司設定中設定截止時間（例如下午 2:00）

2. **截止前（例如下午 1:45）：**
   - 客戶看到：「下午 2:00 前下單可隔日配送」
   - 訂單排定：明天
   - 範例：週一下午 1:45 下單 → 週二配送

3. **截止後（例如下午 2:15）：**
   - 客戶看到：「訂單截止時間（下午 2:00）已過。請聯繫我們安排配送。」
   - 訂單排定：後天（或管理員審核）
   - 範例：週一下午 2:15 下單 → 週三配送（或之後）

**管理員覆寫：**
- 管理員可在截止後下訂單並手動設定隔日配送
- 用於緊急/優先訂單
- 必須在訂單備註中記錄原因

**業務規則：**
- 截止時間僅適用於客戶入口網站訂單
- 管理員下的訂單可繞過截止時間
- 截止時間依公司當地時區（Australia/Sydney）
- 系統在訂單提交時檢查截止時間，而非客戶開始購物時

---

## **7. 包裝與配送流程**

### **7.1 包裝介面**

**目的：** 協助倉庫員工以正確的順序高效包裝訂單以便裝車

**包裝人員如何使用系統：**

1. **選擇配送日期：**
   - 包裝人員選擇日期（預設：明天）
   - 系統顯示該日期所有狀態為 Confirmed（已確認）、Packing（包裝中）或 Ready for Delivery（已備妥配送）的訂單

2. **檢視 1：產品摘要（彙整清單）**
   - 顯示所有訂單所需的總數量
   - 範例：
     ```
     牛臀肉（5kg）：50 單位
     豬里肌（3kg）：30 單位
     雞胸肉（2kg）：20 單位
     ```
   - 包裝人員使用此清單從倉庫高效收集所有產品
   - 勾選清單標記已收集的產品

3. **檢視 2：訂單清單（包裝順序）**
   - 以**最佳包裝順序**顯示個別訂單
   - 訂單編號為 1、2、3 等
   - **依顯示順序包裝**（對裝車很重要）
   - 每張訂單卡片顯示：
     - 訂單編號
     - 客戶名稱
     - 配送地址和區域
     - 待包裝項目（產品、數量、單位）
     - 每個項目的勾選清單
     - 備註欄位

4. **包裝流程：**
   - 包裝人員點擊訂單 #1（第一個包裝）
   - 系統自動將訂單狀態變更為「Packing（包裝中）」
   - 包裝人員標記每個項目為已包裝（勾選框）
   - 包裝人員新增任何備註（例如「少 1kg - 已致電客戶」）
   - 當所有項目勾選完成，包裝人員點擊「標記為已備妥配送」
   - 系統將狀態變更為「Ready for Delivery（已備妥配送）」
   - 包裝人員移至訂單 #2

5. **路線優化：**
   - 包裝人員開啟介面時，系統自動計算最佳包裝順序
   - 若尚未計算，包裝人員看到「優化路線中...」2-5 秒
   - 若有新增訂單，包裝人員可點擊「重新優化路線」

**為何包裝順序很重要：**

**LIFO 策略（後進先出）：**
- 訂單以**反向配送順序**包裝
- 最後配送的先放入貨車（貨車底部/前方）
- 第一個配送的最後放入貨車（貨車頂部/後方）
- 當司機到達第一個配送點時，訂單在貨車後方/頂部容易取得

**範例：**
```
配送路線（系統優化）：
  站點 1：北區 A（第一個配送）
  站點 2：北區 B
  站點 3：東區 C
  站點 4：東區 D（最後配送）

包裝順序（LIFO 反向）：
  先包裝：東區 D（先放入貨車，最後取出）
  第二包裝：東區 C
  第三包裝：北區 B
  最後包裝：北區 A（最後放入貨車，最先取出）
```

**業務規則：**
- 包裝人員必須標記所有項目為已包裝才能完成訂單
- 若包裝人員超過 30 分鐘未與訂單互動，訂單自動恢復為「Confirmed（已確認）」（作業逾時）
- 同一時間只有一位包裝人員可以處理一筆訂單
- 若需重新包裝，包裝人員可重新開啟「Ready for Delivery（已備妥配送）」訂單
- 系統依配送區域分組訂單：北區、東區、南區、西區

### **7.2 配送路線優化**

**系統如何決定最佳路線：**

**步驟 1：依區域分組**
- 系統依配送區域分組訂單（北區、東區、南區、西區）
- 每個區域分別優化

**步驟 2：計算最佳路線**
- 系統使用地圖服務找出造訪所有地址的最短路線
- 考量：距離、交通模式、單行道
- 解決「旅行推銷員問題」- 找出造訪所有站點的最有效順序

**步驟 3：指派配送順序**
- 訂單依配送順序編號：1、2、3 等
- 順序 #1 = 第一個配送站點
- 順序 #8 = 最後一個配送站點

**步驟 4：計算包裝順序**
- 包裝順序為配送順序的反向（LIFO）
- 最後配送 = 先包裝
- 第一配送 = 最後包裝

**步驟 5：顯示給使用者**
- 包裝人員看到包裝順序的訂單
- 司機看到配送順序的訂單
- 兩者都看到預估到達時間

**優化執行時機：**
- **自動** 當包裝人員開啟包裝介面時（若尚未完成）
- **自動** 當訂單數量變更時（新增訂單）
- **手動** 當包裝人員/管理員點擊「優化路線」
- 計算需要 2-5 秒

**司機取得的資訊：**
- 依最佳順序排列的配送清單
- 每個配送顯示：
  - 順序編號（第 1 站、第 2 站等）
  - 客戶名稱和聯絡電話
  - 完整配送地址
  - 配送說明（大門密碼、卸貨碼頭資訊等）
  - 配送項目
  - 預估到達時間
  - 「在 Google Maps 開啟」按鈕供導航

### **7.3 配送流程**

**司機的工作流程：**

1. **早晨準備：**
   - 司機在行動裝置/平板上登入管理入口網站
   - 在配送介面查看今日配送
   - 看到依順序排列的配送：第 1 站、第 2 站等
   - 查看地圖上的路線（如有顯示）

2. **裝載貨車：**
   - 倉庫員工根據包裝順序將訂單裝入貨車
   - 訂單堆放讓第一個配送可以最先取得

3. **開始配送：**
   - 司機標記第一個配送為「Out for Delivery（配送中）」
   - 系統發送電子郵件給客戶：「您的訂單正在配送途中！司機 [姓名] 正在前往。」
   - 司機點擊「在 Google Maps 開啟」進行導航

4. **到達客戶處：**
   - 司機卸貨
   - 配送給客戶聯絡人

5. **配送證明：**
   - 司機必須在標記已配送前取得證明
   - **選項 A：照片** - 司機拍攝已配送貨品或配送地點的照片
   - **選項 B：簽名** - 客戶在司機的裝置螢幕上簽名

6. **完成配送：**
   - 司機上傳配送證明
   - 司機標記訂單為「Delivered（已配送）」
   - 系統發送電子郵件給客戶：「訂單已配送！感謝您的惠顧。」
   - 系統在背景自動建立 Xero 發票

7. **下一站：**
   - 司機移至順序中的下一個配送
   - 重複步驟 3-6

**若客戶不在：**
- 司機無法完成配送
- 司機點擊「退回訂單」
- 司機輸入原因：「客戶不在」、「店家已關門」、「地址錯誤」等
- 訂單狀態變回「Ready for Delivery（已備妥配送）」
- 通知管理員聯繫客戶並重新安排

**緊急狀況：**
- 若管理員需要在司機配送途中取消訂單（少見）：
  - 管理員以「緊急取消」標記取消訂單
  - 司機收到緊急通知：「請勿配送訂單 #[編號] - 返回倉庫」
  - 司機退回訂單
  - 通知客戶取消

**業務規則：**
- 司機必須上傳配送證明（照片或簽名）才能完成配送
- 配送證明永久儲存以備爭議
- 司機只能更新指派給他們的訂單
- 若無法完成配送，司機必須提供原因
- 系統記錄實際到達時間以改進未來路線優化

---

## **8. 定價與客戶管理**

### **8.1 定價策略**

**三種價格類型：**

1. **基本價格**（預設）
   - 由管理員為每項產品設定
   - 適用於所有客戶，除非被覆寫
   - 範例：牛臀肉 5kg = $45.00 基本價格

2. **客戶專屬價格**（議定）
   - 銷售團隊為個別客戶設定的客製價格
   - 僅覆蓋該客戶的基本價格
   - 範例：客戶 ABC 議定 $42.00（相對於 $45.00 基本價格）

3. **合約價格**（限時）
   - 有到期日的客戶專屬價格
   - 範例：特殊價格有效期間 2025 年 1 月 1 日至 12 月 31 日
   - 到期後，客戶恢復為基本價格

**定價顯示方式：**

- **客戶入口網站：**
  - 若客戶有客製價格：僅顯示議定價格
  - 若無客製價格：顯示基本價格
  - 客戶不會看到兩種價格（無比較）

- **管理入口網站：**
  - 顯示基本價格和客製價格（若已設定）
  - 顯示有效日期範圍（如適用）
  - 顯示價格歷史記錄（稽核軌跡）

**價格變更：**
- 變更價格不影響現有訂單
- 訂單在下單時鎖定價格
- 未來訂單使用新定價

### **8.2 付款條件**

**常見付款條件：**

- **COD（貨到付款）：** 客戶在配送時付款
- **Net 7：** 7 天內付款
- **Net 14：** 14 天內付款
- **Net 30：** 30 天內付款
- **自訂條件：** 管理員可輸入任何文字（例如「10 天內付款享 2% 折扣」）

**付款條件運作方式：**
- 管理員在信用核准時設定付款條件
- 條件儲存在客戶帳戶中
- 建立 Xero 發票時，根據條件計算到期日
- 範例：3 月 15 日配送 + Net 30 = 4 月 14 日到期

**系統不處理付款：**
- ERP 追蹤信用額度和訂單
- 實際收款在系統外進行（銀行轉帳、Xero 等）
- Xero 整合建立發票供客戶付款

### **8.3 GST（澳洲稅）處理**

**GST 基礎：**
- GST（商品及服務稅）= 澳洲 10%
- 適用於所有產品銷售
- 包含在 Xero 發票中

**GST 計算方式：**

訂單範例：
```
項目 1：牛臀肉 5kg × 10 單位 × $42.00 = $420.00
項目 2：豬里肌 3kg × 5 單位 × $28.00 = $140.00
─────────────────────────────────────────────────
小計：                                 $560.00
GST（10%）：                          + $56.00
─────────────────────────────────────────────────
總計：                                 $616.00
```

**對客戶的顯示：**
- 訂單摘要顯示：小計 + GST + 總計
- 清楚標示：「GST（10%）」
- 符合澳洲稅務發票要求

**Xero 整合：**
- 系統發送含稅金額到 Xero
- Xero 發票顯示 GST 明細
- Xero 處理 BAS（商業活動報表）的 GST 申報

---

## **9. 庫存管理**

### **9.1 庫存運作方式**

**庫存水準：**

針對每項產品，系統追蹤：
- **目前庫存：** 倉庫目前可用數量
- **低庫存門檻：** 警示水準（例如 10 單位）
- **庫存狀態：**
  - 🟢 **OK（正常）**：庫存高於門檻
  - 🟡 **Low（低）**：庫存等於或低於門檻
  - 🔴 **Out of Stock（缺貨）**：零庫存

**庫存異動：**

每次庫存變更都記錄為**交易**，包含：
- 受影響的產品
- 交易類型（見下方）
- 數量（正數為新增，負數為扣減）
- 變更前後的庫存水準
- 操作人員
- 日期和時間
- 說明原因的備註

**交易類型：**

| 類型 | 代表的意義 | 發生時機 | 數量 |
|------|---------------|-----------------|----------|
| **Sale（銷售）** | 庫存售予客戶 | **自動** 下訂單時 | 負數（扣減庫存） |
| **Adjustment（調整）** | 手動庫存變更 | 管理員因任何原因新增或移除庫存 | 正數或負數 |
| **Return（退回）** | 客戶退貨或取消訂單 | **自動** 訂單取消時 | 正數（加回庫存） |

**備註：** 所有手動庫存變更（收貨、盤點修正、損壞報廢）使用調整類型，並以「調整類型」類別記錄業務原因。

### **9.2 庫存保留（關鍵業務規則）**

**何時扣減庫存：**

**❗ 下訂單時立即扣減（狀態 = Pending（待處理））**

**為何重要：**
- 防止超賣：若庫存 50 單位，3 位客戶各訂 20 單位（共 60），前 2 筆訂單成功，第 3 筆失敗
- 即時準確性：庫存水準永遠是最新的
- 無意外：包裝人員不會在包裝時發現短缺

**範例時間軸：**
```
上午 9:00：目前庫存：100 單位
上午 9:05：客戶 A 下訂 30 單位
         → 庫存立即扣減至 70 單位
上午 9:10：客戶 B 下訂 40 單位
         → 庫存立即扣減至 30 單位
上午 9:15：客戶 C 嘗試下訂 50 單位
         → 訂單被拒絕 - 庫存不足（僅 30 可用）
```

**何時恢復庫存：**

**❗ 訂單取消時立即恢復（任何狀態）**

若訂單因任何原因取消，庫存加回：
- 包裝前取消：庫存退回
- 包裝中取消：庫存退回
- 配送中取消：司機帶回時庫存退回

**範例：**
```
下訂單：30 單位保留（庫存：100 → 70）
訂單取消：30 單位恢復（庫存：70 → 100）
```

### **9.3 手動庫存管理**

**目的：** 所有手動庫存變更都透過庫存調整處理。這包括收貨入庫、盤點差異修正，以及損壞或過期貨品報廢。

**何時使用庫存調整：**

| 情境 | 數量 | 調整類型 | 備註範例 |
|----------|----------|-----------------|---------------|
| 從供應商收貨 | 正數 | 收貨入庫 | 「供應商 ABC 50 單位，發票 #12345」 |
| 實際盤點高於系統 | 正數 | 庫存盤點修正 | 「年度盤點 - D4 貨架發現多 2 個」 |
| 實際盤點低於系統 | 負數 | 庫存盤點修正 | 「季度盤點 - 短缺 3 單位」 |
| 損壞品 | 負數 | 損壞品 | 「5 單位水損，已報廢」 |
| 過期庫存 | 負數 | 過期庫存 | 「批次 #789 已過有效期限」 |

**調整類型（下拉選項）：**

1. **收貨入庫** - 從供應商送貨、調撥或其他來源新增庫存
2. **庫存盤點修正** - 修正盤點時發現的差異（可正可負）
3. **損壞品** - 報廢無法銷售的損壞庫存
4. **過期庫存** - 報廢超過有效期限的庫存

**流程：**

1. 管理員前往管理入口網站 → 庫存 → 選擇產品
2. 點擊「調整庫存」
3. 從下拉選單選擇**調整類型**
4. 輸入數量：
   - **正數** 增加庫存（例如 +100 收貨）
   - **負數** 減少庫存（例如 -5 損壞品）
5. 輸入**必填備註**說明調整原因
6. 點擊「儲存」
7. 系統：
   - 更新目前庫存水準
   - 建立「調整」交易記錄，包含類型和備註
   - 記錄管理員名稱和時間戳記供稽核
   - 更新庫存狀態（可能觸發低庫存警示或清除現有警示）

**範例：**

**範例 1 - 收貨入庫：**
```
情境：供應商 ABC 配送 100 箱牛臀肉
管理員輸入：
  - 調整類型：收貨入庫
  - 數量：+100
  - 備註：「供應商 ABC 發票 #12345，配送日期 2025-01-15」
結果：庫存從 20 增加到 120 單位
```

**範例 2 - 庫存盤點修正（負數）：**
```
情境：盤點發現僅 48 單位，系統顯示 50
管理員輸入：
  - 調整類型：庫存盤點修正
  - 數量：-2
  - 備註：「年度盤點 - B3 貨架短缺 2 單位」
結果：庫存從 50 減少到 48 單位
```

**範例 3 - 損壞品：**
```
情境：5 單位被堆高機損壞
管理員輸入：
  - 調整類型：損壞品
  - 數量：-5
  - 備註：「倉庫堆高機事故，已報廢」
結果：庫存減少，記錄庫存差異供稽核
```

**業務規則：**
- 所有調整需要備註（必填欄位）
- 管理員名稱和時間戳記自動記錄
- 交易記錄無法刪除（永久稽核軌跡）
- 調整立即反映在可用庫存中
- 低庫存警示可能根據新庫存水準觸發或清除

### **9.4 低庫存警示**

**警示運作方式：**

1. **設定門檻：** 每項產品有低庫存門檻（例如 10 單位）
2. **監控：** 系統持續檢查庫存水準
3. **觸發警示：** 當庫存降至或低於門檻時
4. **通知：** 發送電子郵件給倉庫經理和管理員
5. **警示內容：**
   - 產品名稱和 SKU
   - 目前庫存水準
   - 低庫存門檻
   - 建議補貨數量（選填）

**警示頻率：**
- 首次警示：達到門檻時立即發送
- 後續警示：每小時批次摘要（避免過多訊息）
- 警示清除：庫存補充超過門檻時

**儀表板指示：**
- 管理儀表板顯示低庫存產品數量
- 點擊查看完整清單
- 產品顏色標示：🟡 低庫存、🔴 缺貨

---

## **10. 會計整合**

### **10.1 Xero 整合概述**

**什麼是 Xero：**
- 澳洲廣泛使用的雲端會計軟體
- 處理發票開立、付款、GST 申報、財務報表

**為何整合很重要：**
- **消除重複輸入：** ERP 訂單自動成為 Xero 發票
- **減少錯誤：** 無需手動建立發票
- **節省時間：** 訂單配送時自動同步
- **準確會計：** 訂單總額、GST、客戶詳情完美同步

**同步到 Xero 的項目：**

1. **客戶** → Xero 聯絡人（信用核准時）
2. **已配送訂單** → Xero 發票（配送完成時）
3. **已取消訂單** → Xero 折讓單（若發票已存在）

### **10.2 客戶同步**

**客戶何時同步到 Xero：**
- **觸發：** 管理員核准信用申請
- **發生的事項：**
  - 系統在 Xero 中建立聯絡人，包含客戶企業詳情：
    - 企業名稱
    - 聯絡人姓名
    - 電子郵件和電話
    - 配送地址
    - ABN（澳洲商業號碼）
  - 系統在客戶記錄中儲存 Xero 聯絡人 ID
  - 未來客戶詳情更新可同步到 Xero

**業務規則：**
- 客戶必須核准後才能同步
- 若 Xero 同步失敗，客戶核准仍然成功（會計非營運關鍵）
- 同步失敗時通知管理員
- 管理員可手動重試同步

### **10.3 發票建立**

**何時建立發票：**

**❗ 訂單狀態變更為「Delivered（已配送）」時自動建立**

**流程：**

1. **司機標記訂單為已配送**（附配送證明）
2. **訂單狀態變更為「Delivered（已配送）」** - 此步驟立即完成
3. **系統排入背景工作：**「為訂單 #[編號] 建立 Xero 發票」
4. **背景工作執行**（數秒內，不延遲配送完成）：
   - 取得訂單詳情：客戶、項目、價格、GST
   - 檢查客戶是否存在於 Xero（若否，先同步客戶）
   - 在 Xero 中建立發票，包含：
     - 客戶為聯絡人
     - 訂單項目為明細項目
     - 已計算 GST
     - 訂單編號為發票參考
     - 根據付款條件計算到期日
   - 在訂單記錄中儲存 Xero 發票 ID 和發票編號
5. **發票出現在 Xero** 供企業主管理付款

**Xero 發票範例：**

```
發票 #：INV-2025-00123
客戶：ABC Butchers Pty Ltd
日期：2025-01-15
到期日：2025-02-14（Net 30）
參考：ORD-2025-001234

明細項目：
  牛臀肉 5kg × 10   @ $42.00 = $420.00
  豬里肌 3kg × 5    @ $28.00 = $140.00
                        小計 = $560.00
                        GST 10%  = $56.00
                        總計    = $616.00
```

**錯誤處理：**

- **若發票建立失敗：**
  - 訂單仍為「Delivered（已配送）」（配送已完成，與此無關）
  - 錯誤訊息儲存在訂單記錄中
  - 管理員收到電子郵件通知：「訂單 #[編號] 的 Xero 同步失敗」
  - 系統自動重試 3 次（間隔 1 分鐘）
  - 若仍失敗，管理員可從訂單詳情頁面手動觸發同步

**為何使用自動背景處理：**
- 配送完成是關鍵，不能被延遲
- 會計可在數秒後完成，不影響營運
- 司機不需要等待 Xero 回應
- 允許系統重試失敗同步而不影響工作流程

### **10.4 折讓單**

**何時建立折讓單：**

**觸發：** 訂單取消且 Xero 發票已存在

**流程：**

1. **管理員取消訂單**（例如客戶來電取消）
2. **系統將訂單變更為「Cancelled（已取消）」** 並恢復庫存
3. **系統檢查：** 此訂單是否有 Xero 發票 ID？
4. **若有：**
   - 系統排入背景工作：「為訂單 #[編號] 建立 Xero 折讓單」
   - 背景工作在 Xero 中建立折讓單：
     - 相同客戶
     - 相同明細項目
     - 相同金額（全額折讓）
     - 參考：「訂單 ORD-2025-001234 的折讓 - [原因]」
   - 在訂單記錄中儲存 Xero 折讓單 ID
   - 客戶收到包含折讓單詳情的電子郵件
5. **若無：**
   - 不需要動作（發票從未建立）

**範例情境：**

```
時間軸：
1 月 15 日：訂單下單並配送 → 建立 Xero 發票
1 月 20 日：客戶來電退回整筆訂單 → 訂單取消
        → 系統在 Xero 中建立折讓單
        → 客戶帳戶折讓 $616.00
```

**業務規則：**
- 僅在發票存在時建立折讓單
- 折讓單與原始發票金額完全相符
- 取消原因包含在折讓單參考中
- 通知客戶折讓單建立

### **10.5 Xero 設定與監控**

**初始設定（一次性）：**

1. 管理員前往管理入口網站 → 公司設定 → Xero 整合
2. 點擊「連接 Xero」
3. 重新導向至 Xero 網站進行授權
4. 管理員登入 Xero 並核准存取
5. 系統儲存安全連接權杖
6. 管理員返回公司設定，顯示「已連接 Xero ✓」

**監控同步狀態：**

**Xero 儀表板：**
- 上次同步時間：「上次同步：2025-01-15 下午 3:45」
- 已同步客戶總數：47
- 已建立發票總數：234
- 已建立折讓單總數：5
- 失敗同步：2（附錯誤詳情）

**同步錯誤日誌：**
- 訂單編號
- 錯誤訊息（例如「Xero 中找不到客戶」、「無效發票資料」）
- 日期和時間
- 每個失敗同步的「重試」按鈕

**手動操作：**
- 「同步所有待處理發票」- 為所有缺少發票 ID 的已配送訂單建立發票
- 「同步客戶」- 手動將個別客戶同步到 Xero
- 「重試失敗同步」- 重試特定訂單的發票/折讓單建立
- 「中斷 Xero 連接」- 移除連接（管理員稍後必須重新連接）

**業務規則：**
- 只有管理員角色可以連接/中斷 Xero
- 連接權杖安全加密
- 權杖 60 天後過期 - 系統自動更新
- 若權杖更新失敗，管理員必須手動重新連接

---

## **11. 通知與通訊**

### **11.1 電子郵件通知對照表**

**電子郵件發送時機、對象和原因的完整清單：**

#### **客戶端電子郵件**（外部通訊）

| 時機 | 發送的電子郵件 | 對象 | 內容 | 優先順序 |
|------|-----------|-----|---------|----------|
| 客戶註冊 | 「註冊確認」 | 客戶 | 歡迎訊息、申請待審核中、預計 1-2 個工作日回覆 | 高 |
| 信用核准 | 「信用申請已核准」 | 客戶 | 恭喜、信用額度金額、付款條件、可以開始下訂單 | 高 |
| 信用拒絕 | 「信用申請更新」 | 客戶 | 申請被拒絕、提供原因、聯繫銷售討論其他方案 | 高 |
| 下訂單 | 「訂單確認」 | 客戶 | 訂單編號、項目、總額、配送日期、「感謝您」 | 高 |
| 管理員確認訂單 | 「訂單已確認」 | 客戶 | 訂單正在準備包裝 | 高 |
| 訂單已備妥配送 | 「訂單已包裝」（選填） | 客戶 | 訂單已包裝完成，等待發貨 | 低 |
| 司機開始配送 | 「訂單配送中」 | 客戶 | 司機姓名、「您的訂單正在配送途中」 | 高 |
| 訂單已配送 | 「訂單已配送」 | 客戶 | 感謝您、配送證明圖片/簽名、發票將隨後發送 | 高 |
| 訂單取消（早期） | 「訂單已取消」 | 客戶 | 取消原因、庫存已恢復、如適用則退款 | 高 |
| 訂單取消（晚期） | 「訂單已取消 - 緊急」 | 客戶 | 致歉、取消原因、全額退款、聯絡詳情 | 高 |
| 建立折讓單 | 「折讓單已發出」 | 客戶 | 退款金額、折讓單編號、原因 | 高 |
| **缺貨訂單已提交** | 「缺貨訂單已提交審核」 | 客戶 | 訂單詳情、哪些項目短缺、預計審核時程（1-2 天） | 高 |
| **缺貨訂單已核准** | 「缺貨訂單已核准」 | 客戶 | 核准確認、如有提供預計出貨日期 | 高 |
| **缺貨訂單部分核准** | 「缺貨訂單部分核准」 | 客戶 | 原始與核准數量、更新的訂單總額、管理員備註 | 高 |
| **缺貨訂單已拒絕** | 「缺貨訂單已拒絕」 | 客戶 | 拒絕原因、替代方案（聯繫我們、調整訂單） | 高 |

#### **內部員工電子郵件**（內部通訊）

| 時機 | 發送的電子郵件 | 對象 | 內容 | 優先順序 |
|------|-----------|-----|---------|----------|
| 新客戶註冊 | 「新客戶註冊」 | 管理員、銷售 | 客戶詳情、審核信用申請 | 中 |
| 下訂單 | 「新訂單通知」 | 管理員、銷售 | 訂單詳情、客戶、總金額 | 中 |
| **缺貨訂單已提交** | 「新缺貨訂單需要核准」 | 管理員、銷售 | 客戶名稱、訂單詳情、庫存短缺明細、核准連結 | 高 |
| 訂單已確認 | 「倉庫新訂單」 | 倉庫團隊 | 訂單已確認，準備明天包裝 | 中 |
| 訂單已備妥配送 | 「新配送已備妥」 | 配送團隊 | 訂單已包裝，等待指派司機 | 中 |
| 包裝作業逾時 | 「包裝作業逾時警示」 | 倉庫經理 | 訂單包裝超過 30 分鐘無活動，已恢復為已確認 | 中 |
| 低庫存警示 | 「低庫存警示摘要」 | 倉庫經理、管理員 | 低於門檻的產品清單、目前水準、建議補貨 | 中（每小時批次） |
| Xero 同步成功（選填） | 「Xero 同步完成」 | 管理員 | 建立的發票數量、時間戳記 | 低 |
| Xero 同步失敗 | 「Xero 同步錯誤」 | 管理員 | 訂單編號、錯誤訊息、需要手動處理 | 高 |
| 訂單取消（包裝中+） | 「訂單取消 - 倉庫」 | 倉庫團隊 | 訂單在包裝中取消，從佇列移除 | 高 |
| 訂單取消（配送中） | 「訂單取消 - 司機緊急」 | 被指派的司機 | 請勿配送訂單 #[編號]，立即返回倉庫 | 關鍵 |
| 路線優化完成 | 「路線已優化」 | 倉庫經理 | 配送日期、訂單數量、總距離、地圖連結 | 低 |
| 配送完成（選填） | 「配送完成報告」 | 管理員 | 每日配送摘要、成功配送、問題 | 低 |

### **11.2 電子郵件時機**

**即時（同步）- 在使用者操作期間發送：**
- 訂單確認（客戶下訂單 - 必須收到確認）
- 訂單已確認（管理員確認 - 客戶需要知道）
- 訂單配送中（司機開始 - 客戶期待通知）
- 訂單已配送（司機完成 - 發送配送證明）
- 訂單已取消（任何取消 - 必須通知客戶）
- 缺貨訂單已提交（客戶和管理員需要立即知道）
- 缺貨訂單決定（核准/拒絕/部分 - 客戶需要及時通知）

**背景（非同步）- 由系統工作發送：**
- Xero 同步結果（在訂單完成後發生）
- 低庫存警示（每小時批次以避免過多訊息）
- 路線優化完成（資訊性）
- 每日配送報告（當日結束摘要）

**為何重要：**
- **即時電子郵件** 可能延遲使用者操作 1-2 秒（關鍵通知可接受）
- **背景電子郵件** 不延遲使用者操作（更好的使用者體驗）
- **關鍵操作**（如配送完成）若電子郵件失敗不能失敗

### **11.3 電子郵件內容指南**

**良好電子郵件實踐：**

1. **清楚的主旨：**
   - ✅ 「訂單確認 - ORD-2025-001234」
   - ❌ 「您的訂單」

2. **個人化：**
   - 以聯絡人姓名稱呼客戶
   - 包含相關詳情（訂單編號、客戶名稱）

3. **可操作：**
   - 如需要，包含後續步驟
   - 提供問題的聯絡資訊

4. **專業：**
   - Jimmy Beef 品牌識別
   - 一致的格式
   - 正確的文法和拼寫

5. **行動裝置友善：**
   - 許多客戶在手機上閱讀
   - 連結使用大按鈕
   - 內容簡潔

**電子郵件模板包含：**
- 公司標誌
- 清楚的標題
- 訂單詳情表格（項目、數量、價格）
- 行動呼籲按鈕（例如「查看訂單」、「聯繫我們」）
- 包含聯絡資訊的頁尾
- 取消訂閱連結（行銷電子郵件，非交易性）

---

## **12. 業務規則摘要**

### **12.1 客戶規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **需要信用核准** | 客戶必須有已核准的信用申請才能下訂單 | 未核准的客戶看到「待核准」訊息，無法結帳 |
| **信用額度執行** | 訂單總額 + 未結餘額不能超過信用額度 | 超過額度的訂單被拒絕，客戶必須聯繫銷售 |
| **僅限服務區域** | 配送地址必須在系統的區域清單中 | 若找不到區域仍允許註冊但需管理員核准 |
| **唯一電子郵件** | 每位客戶必須有唯一的電子郵件地址 | 若電子郵件已存在則註冊失敗 |
| **ABN 格式** | 澳洲商業號碼必須為 11 位數字 | ABN 無效則註冊失敗 |
| **帳戶停用** | 已停用的帳戶無法登入或下訂單 | 客戶看到「帳戶已停用」訊息 |
| **自助取消視窗** | 客戶只能取消 Pending（待處理）狀態的訂單 | 確認後必須聯繫管理員 |

### **12.2 訂單規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **訂單截止時間** | 截止前下的訂單（例如下午 2 點）符合隔日配送資格 | 截止後，配送日期為後天 |
| **庫存保留** | 下訂單時立即扣減庫存（一般訂單）或缺貨訂單核准時 | 防止超賣，確保包裝人員有庫存 |
| **最低數量** | 無最低訂購數量（除非設定） | 允許小額訂單 |
| **連續訂單編號** | 訂單編號自動按順序產生 | 格式：ORD-2025-001234 |
| **價格鎖定** | 訂單在下單時鎖定價格 | 未來價格變更不影響現有訂單 |
| **狀態進程** | 訂單必須遵循有效的狀態轉換 | 無法跳過狀態（例如待處理不能直接跳到已配送） |
| **取消規則** | 已配送的訂單無法取消（使用退貨流程） | 配送後必須作為退貨/退款處理 |
| **經理核准** | 取消包裝中/配送中的訂單需經理核准 | 防止流程後期的意外取消 |

### **12.3 庫存規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **不能負庫存** | 庫存不能低於零 | 庫存不足時一般訂單被拒絕；缺貨訂單提交待核准 |
| **即時保留** | 下訂單時扣減庫存（一般訂單）或缺貨訂單核准時 | 即時庫存準確性 |
| **即時恢復** | 訂單取消時恢復庫存 | 取消的庫存立即可供新訂單使用 |
| **交易記錄** | 所有庫存變更永久記錄 | 完整稽核軌跡，無法刪除交易 |
| **低庫存門檻** | 產品專屬或公司預設 | 庫存降至/低於門檻時發送警示 |
| **手動調整** | 需要管理員角色和必填備註 | 防止未授權變更，記錄原因 |

### **12.4 定價規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **基本價格回退** | 若無客製價格，客戶看到基本價格 | 所有客戶都能看到價格 |
| **客製價格優先** | 客戶專屬價格覆蓋基本價格 | 遵守議定交易 |
| **有效日期範圍** | 客製價格可設定開始和結束日期 | 合約定價可自動到期 |
| **訂單價格鎖定** | 訂單在下單時鎖定價格 | 溯及既往的價格變更不影響訂單 |
| **稽核軌跡** | 所有定價變更記錄誰/何時/為何 | 完整定價歷史 |

### **12.5 配送規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **需要配送證明** | 無照片或簽名無法標記已配送 | 防止配送爭議 |
| **LIFO 包裝順序** | 訂單以反向配送順序包裝 | 最後配送先放入貨車，容易取得 |
| **路線優化** | 系統計算最佳路線 | 最小化距離，減少油費，更快配送 |
| **配送區域分組** | 訂單依區域分組（北、東、南、西） | 高效路線規劃，可預測的排程 |
| **司機指派** | 僅被指派的司機可以更新訂單 | 防止混淆，明確責任 |
| **退回流程** | 司機可退回無法配送的訂單 | 處理客戶不在、地址錯誤等情況 |
| **預估到達時間** | 系統計算每站的預估到達時間 | 客戶知道何時期待配送 |

### **12.6 Xero 整合規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **配送時開發票** | 訂單配送時自動建立發票 | 無需手動輸入發票 |
| **取消時建折讓單** | 若開發票後訂單取消，建立折讓單 | 已取消訂單的正確會計處理 |
| **非同步處理** | Xero 操作在背景執行 | 不延遲配送完成 |
| **重試邏輯** | 失敗同步自動重試 3 次 | 處理暫時性 Xero API 問題 |
| **手動備援** | 管理員可手動觸發同步 | 若自動同步失敗，管理員可修復 |
| **GST 合規** | 所有發票包含 10% GST | 符合澳洲稅務要求 |

### **12.7 缺貨訂單規則**

| 規則 | 說明 | 影響 |
|------|-------------|--------|
| **庫存短缺觸發缺貨訂單** | 超過可用庫存的訂單成為缺貨訂單 | 客戶不會被直接拒絕，訂單提交審核 |
| **需要管理員核准** | 缺貨訂單需要明確的管理員決定 | 管理員控制對無法供應庫存的承諾 |
| **三種核准選項** | 管理員可完全核准、部分核准或拒絕 | 靈活處理庫存短缺 |
| **延遲庫存保留** | 建立缺貨訂單時不扣減庫存 | 僅在管理員核准時保留 |
| **信用額度排除** | 待處理的缺貨訂單不計入信用額度 | 客戶可在等待期間下其他訂單 |
| **拒絕需要原因** | 管理員必須提供至少 10 字元的說明 | 客戶了解訂單被拒絕的原因 |
| **部分核准重算** | 部分核准數量時重新計算訂單總額 | 調整後訂單的準確帳單 |
| **自動狀態進程** | 已核准的缺貨訂單直接移至已確認 | 無需額外確認步驟 |
| **客戶通知** | 每個缺貨訂單決定都發送電子郵件給客戶 | 全程透明 |
| **稽核軌跡** | 記錄核准/拒絕的管理員和時間戳記 | 決定的責任歸屬 |

---

## **附錄：業務術語詞彙表**

| 術語 | 定義 |
|------|------------|
| **ABN** | Australian Business Number（澳洲商業號碼）- 澳洲企業的唯一 11 位數識別碼 |
| **Admin（管理員）** | 擁有完整系統存取權限的內部員工 |
| **Area Tag（區域標籤）** | 指派給配送地址的地理標示（北區、東區、南區、西區） |
| **Backorder（缺貨訂單）** | 因庫存不足無法立即履行、需要管理員核准的訂單 |
| **Backorder Status（缺貨訂單狀態）** | 缺貨訂單的目前狀態：Pending Approval（待核准）、Approved（已核准）、Partially Approved（部分核准）或 Rejected（已拒絕） |
| **Base Price（基本價格）** | 產品的預設價格，除非被客製定價覆蓋否則適用 |
| **Credit Application（信用申請）** | 客戶申請信用額度和付款條件 |
| **Credit Limit（信用額度）** | 客戶可擁有的未結訂單最高金額 |
| **Credit Note（折讓單）** | 退還客戶已取消訂單款項的會計文件 |
| **Cutoff Time（截止時間）** | 每日訂單符合隔日配送資格的截止時間（例如下午 2:00） |
| **Custom Pricing（客製定價）** | 針對個別客戶的議定價格 |
| **Delivery Sequence（配送順序）** | 司機造訪配送地址的數字順序（第 1 站、第 2 站等） |
| **Expected Fulfillment（預計出貨）** | 缺貨訂單預計履行的日期（預期庫存到貨時間） |
| **GST** | Goods and Services Tax（商品及服務稅）- 澳洲 10% 銷售稅 |
| **Inventory Transaction（庫存交易）** | 庫存變更記錄（銷售、調整、退回） |
| **Invoice（發票）** | 要求支付已配送訂單款項的會計文件 |
| **LIFO** | Last-In-First-Out（後進先出）- 最後配送先放入貨車的包裝策略 |
| **Low Stock Threshold（低庫存門檻）** | 觸發低庫存警示的數量水準 |
| **Order Number（訂單編號）** | 每筆訂單的唯一識別碼（格式：ORD-2025-001234） |
| **Outstanding Balance（未結餘額）** | 計入信用額度的未配送訂單總金額 |
| **Packing Sequence（包裝順序）** | 倉庫包裝訂單的數字順序（配送順序的反向） |
| **Partial Approval（部分核准）** | 管理員決定以調整後數量核准缺貨訂單（僅核准可用庫存） |
| **Payment Terms（付款條件）** | 客戶支付發票時間的協議（COD、Net 30 等） |
| **POD** | Proof of Delivery（配送證明）- 確認配送的照片或簽名 |
| **Route Optimization（路線優化）** | 計算最有效配送路線的演算法 |
| **SKU** | Stock Keeping Unit（庫存單位）- 唯一產品代碼 |
| **Stock Adjustment（庫存調整）** | 管理員對庫存水準的手動變更，用於收貨入庫、盤點修正或報廢損壞/過期貨品。依類型分類：收貨入庫、庫存盤點修正、損壞品、過期庫存 |
| **Stock Reservation（庫存保留）** | 下訂單時扣減庫存（非配送時） |
| **Stock Shortfall（庫存短缺）** | 要求數量與可用庫存之間觸發缺貨訂單的差額 |
| **Suburb Area Mapping（區域對應）** | 連結區域與配送區域的資料庫 |
| **Suspended Account（已停用帳戶）** | 暫時停用的客戶帳戶（無法登入或下訂單） |
| **Xero** | Jimmy Beef 使用的雲端會計軟體 |

---

**功能規格文件結束**
